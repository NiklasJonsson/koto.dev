{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="/docs.css" />
{% endblock head %}

{% block content %}

<nav class="docs-sidebar" role="navigation">
  <ul class="uk-nav uk-nav-default">
    {% set index = get_section(path="docs/_index.md") %}

    {% for s in index.subsections %}
      {% set subsection = get_section(path=s) %}

      <li class="uk-nav-header{% if current_path == subsection.path %} uk-active{% endif %}">
        <a href="{{ subsection.permalink }}">
          {{ subsection.title }}
        </a>
      </li>

      {% if page %}
        {% set parent_name = page.ancestors | last %}
        {% set parent = get_section(path = parent_name) %}
        {% set show_pages = parent == subsection %}
      {% endif %}

      {% if section %}
        {% set show_pages = section == subsection %}
      {% endif %}

      {% if show_pages %}
        {% for p in subsection.pages %}

        <li class="{% if current_path == p.path %}uk-active uk-parent{% endif %}">
          <a href="{{ p.permalink }}">
            {{ p.title }}
          </a>

          {% if current_path == p.path %}
            {% set first_header = p.toc | first %}

            {% if first_header.children | length > 0 %}
              <ul class="uk-nav-sub uk-nav-default">
                {% for h1 in p.toc %}
                  {% for h2 in h1.children %}
                  <li>
                    <a href="{{ h2.permalink | safe }}">{{ h2.title }}</a>
                  </li>
                  {% endfor %}
                {% endfor %}
              </ul>
            {% endif %}
          {% endif %}
        </li>
        {% endfor %}
      {% endif %}
    {% endfor %}
  </ul>
</nav>

<div class="docs-section uk-section uk-section-default">
  <div class="uk-container uk-container-small">
    <div>
      {% block docscontent %} {% endblock %}
    </div>
  </div>
</div>

{% endblock content %}
